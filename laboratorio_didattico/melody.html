
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Il significato sociale della musica in età evolutiva &#8212; Psicometria</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/icons8-graduation-cap-30.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modalità di verifica dell’apprendimento" href="../esame.html" />
    <link rel="prev" title="Istruzioni E-tivity" href="laboratorio_didattico.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/altair-hist.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Psicometria</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Psicometria
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  A.A. 2022-2023
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../materiali_didattici.html">
   Materiali didattici
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../come_studiare.html">
   Come studiare
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../calendario.html">
   Calendario
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="laboratorio_didattico_index.html">
   Laboratorio didattico
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="laboratorio_didattico.html">
     Istruzioni E-tivity
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Il significato sociale della musica in età evolutiva
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../esame.html">
   Modalità di verifica dell’apprendimento
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq.html">
   FAQ
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Esercizi
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/01_python/python_index.html">
   1. Python per la data analisi
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/01_python/ex_python.html">
     1.1. ✅ Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/01_python/ex_pandas.html">
     1.2. ✅ Pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/02_descr_stats/descr_stats_index.html">
   2. Statistica descrittiva
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/02_descr_stats/ex_key_notions.html">
     2.1. ✅ Concetti chiave
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/02_descr_stats/ex_scales.html">
     2.2. ✅ Scale di misura
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/02_descr_stats/ex_sums.html">
     2.3. ✅ Sommatorie
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/02_descr_stats/ex_eda.html">
     2.4. ✅ EDA
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/03_prob/prob_index.html">
   3. Teoria della probabilità
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/03_prob/ex_combinatorics.html">
     3.1. ✅ Calcolo combinatorio
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/03_prob/ex_conditional_prob.html">
     3.2. ✅ Probabilità condizionata
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/03_prob/ex_bayes_theorem.html">
     3.3. ✅ Teorema di Bayes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/04_rv_distr/rv_distr_index.html">
   4. Distribuzioni di variabili casuali
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/04_rv_distr/ex_rv_discrete.html">
     4.1. ✅ Variabili casuali discrete
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/04_rv_distr/ex_binomial.html">
     4.2. ✅ Distribuzione binomiale
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/04_rv_distr/ex_gaussian.html">
     4.3. ✅ Distribuzione Normale
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/04_rv_distr/ex_beta_distr.html">
     4.4. ✅ Distribuzione Beta
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/05_joint_prob/joint_prob_index.html">
   5. Probabilità congiunta
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/05_joint_prob/ex_joint_prob.html">
     5.1. ✅ Probabilità congiunta
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ccaudek/psicometria_2023/master?urlpath=tree/laboratorio_didattico/melody.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/ccaudek/psicometria_2023/blob/master/laboratorio_didattico/melody.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ccaudek/psicometria_2023"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ccaudek/psicometria_2023/issues/new?title=Issue%20on%20page%20%2Flaboratorio_didattico/melody.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/laboratorio_didattico/melody.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivazione">
   Motivazione
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analisi-dei-dati">
   Analisi dei dati
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-t-di-student-per-un-solo-campione">
     Test
     <span class="math notranslate nohighlight">
      \(t\)
     </span>
     di Student per un solo campione
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#approccio-frequentista">
       Approccio frequentista
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analisi-bayesiana">
       Analisi Bayesiana
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confronto-tra-due-gruppi">
     Confronto tra due gruppi
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#approccio-frequentista-test-t-di-student-per-campioni-appaiati">
       Approccio frequentista (test
       <span class="math notranslate nohighlight">
        \(t\)
       </span>
       di Student per campioni appaiati)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Analisi bayesiana
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analisi-di-regressione">
     Analisi di regressione
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Approccio frequentista
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inferenza-bayesiana">
       Inferenza bayesiana
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusioni">
   Conclusioni
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#riferimenti-bibliografici">
   Riferimenti bibliografici
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Il significato sociale della musica in età evolutiva</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivazione">
   Motivazione
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analisi-dei-dati">
   Analisi dei dati
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-t-di-student-per-un-solo-campione">
     Test
     <span class="math notranslate nohighlight">
      \(t\)
     </span>
     di Student per un solo campione
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#approccio-frequentista">
       Approccio frequentista
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analisi-bayesiana">
       Analisi Bayesiana
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confronto-tra-due-gruppi">
     Confronto tra due gruppi
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#approccio-frequentista-test-t-di-student-per-campioni-appaiati">
       Approccio frequentista (test
       <span class="math notranslate nohighlight">
        \(t\)
       </span>
       di Student per campioni appaiati)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Analisi bayesiana
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analisi-di-regressione">
     Analisi di regressione
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Approccio frequentista
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inferenza-bayesiana">
       Inferenza bayesiana
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusioni">
   Conclusioni
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#riferimenti-bibliografici">
   Riferimenti bibliografici
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="il-significato-sociale-della-musica-in-eta-evolutiva">
<h1>Il significato sociale della musica in età evolutiva<a class="headerlink" href="#il-significato-sociale-della-musica-in-eta-evolutiva" title="Permalink to this headline">#</a></h1>
<section id="motivazione">
<h2>Motivazione<a class="headerlink" href="#motivazione" title="Permalink to this headline">#</a></h2>
<p>La produzione e fruizione della musica è una caratteristica universale del genere umano. I neonati umani imparano e ricordano le melodie e si muovono spontaneamente al ritmo della musica. I genitori cantano frequentemente delle canzoni ai loro figli piccoli, in uno stile che è comune a molte culture. Ci possiamo dunque chiedere quale sia la <em>funzione</em> di questo comportamento dei genitori nei confronti dei loro figli. Mehr, Song e Spelke (2016) esplorano l’ipotesi che la melodia, una caratteristica saliente della musica vocale, trasmetta informazioni sociali ai bambini.</p>
<p>Per valutare questa ipotesi, Mehr et al. (2016) esaminano un campione di 32 bambini di età media pari a 5.6 mesi (SD = 0.31, gamma di variazione: 5.1–6.1). Nel loro primo esperimento, Mehr e al. si chiedono se la familiarità con una melodia possa modulare una preferenza sociale, ovvero possa influenzare i tempi di fissazione dello sguardo (<em>looking-time</em>) che i bambini dirigono verso un individuo adulto sconosciuto che, cantando, produce una melodia conosciuta.</p>
<p>Nella prima fase dell’esperimento, ai genitori dei bambini veniva chiesto di imparare una nuova ninna-nanna e di ripeterla spesso al figlio/a. Nella seconda fase dell’esperimento, ai bambini venivano presentati due video, uno di fianco all’altro.  Uno dei due video faceva vedere uno sconosciuto che cantava la melodia che, in precedenza, i genitori avevano presentato ai bambini; l’altro video faceva vedere uno sconosciuto che cantava una ninna-nanna diversa. La variabile dipendente era il tempo di fissazione dello sguardo del bambino.</p>
<p><img alt="" src="../_images/melody.png" /></p>
<p>Nelle prove baseline (16 s ciascuna), ai bambini vennero presentati due video che facevano vedere gli stessi due adulti che, nella fase test, cantavano le due melodie; in questo caso, però gli attori non cantavano ma si limitavano a sorridere.</p>
<p>Mediante una prima analisi statistica gli autori hanno verificato che i bambini non dimostravano alcuna preferenza per uno dei due sconosciuti, quando questi non cantavano. In una seconda analisi statistica, gli autori si sono chiesti se i tempi di fissazione dello sguardo fossero maggiori quando lo sconosciuto cantava la ninna-nanna familiare piuttosto che quella non familiare.</p>
<p>L’analisi statistica eseguita dagli autori è un test <span class="math notranslate nohighlight">\(t\)</span> di Student. L’articolo di Mehr et al. (2016) riporta un valore della statistica test pari a <span class="math notranslate nohighlight">\(t_{31} = 2.96\)</span>, un <span class="math notranslate nohighlight">\(p\)</span>-valore di 0.06 e un intervallo di confidenza al 95% pari a [0.529, 0.658]. La dimensione dell’effetto, misurata con un <span class="math notranslate nohighlight">\(d\)</span> di Cohen, è pari a 0.52.</p>
<p>Lo scopo dell’analisi statistica riportata qui di seguito è quello di replicare questi risultati mediante l’analisi dei dati messi a disposizione dagli autori. La stessa analisi statistica verrà eseguita usando due metodi diversi: l’approccio frequentista e l’approccio bayesiano.</p>
</section>
<section id="analisi-dei-dati">
<h2>Analisi dei dati<a class="headerlink" href="#analisi-dei-dati" title="Permalink to this headline">#</a></h2>
<p>Per replicare i risultati riportati da  Mehr et al. (2016), importiamo i dati contenuti nel file <code class="docutils literal notranslate"><span class="pre">MehrSongSpelke_exp_1.csv</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">bambi</span> <span class="k">as</span> <span class="nn">bmb</span>
<span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">from</span> <span class="nn">pymc</span> <span class="kn">import</span> <span class="n">HalfNormal</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Normal</span><span class="p">,</span> <span class="n">sample</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">RANDOM_SEED</span> <span class="o">=</span> <span class="mi">2023</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">RANDOM_SEED</span><span class="p">)</span>
<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;arviz-darkgrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;tableau-colorblind10&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il DataFrame è costituito da 96 righe e 153 colonne.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;MehrSongSpelke_exp_1.csv&quot;</span><span class="p">)</span>
<span class="n">tot_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(96, 153)
</pre></div>
</div>
</div>
</div>
<p>Esamino i nomi delle colonne.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">tot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id study_code exp1 exp2 exp3 exp4 exp5 dob dot1 dot2 dot3 female dad train Baseline_Proportion_Gaze_to_Singer Familiarization_Gaze_to_Familiar Familiarization_Gaze_to_Unfamiliar Test_Proportion_Gaze_to_Singer Difference_in_Proportion_Looking Estimated_Total_Number_of_Song totskypesing stim othersing comply_no module skype_before ammat ammar ammatot ammapr ipad_num famtot_6 unfamtot_6 totprac totw totnw age length delay mtotsing mbabylike msingcomf mtotrecord m_othersong pright diarymissing comply_fup survey_completion smsingrate smtalkrate gzsingrate gztalkrate famtot unfamtot totsing1 babylike1 singcomf1 totrecord1 othersong1 dtword1 dtnoword1 totsing2 babylike2 singcomf2 totrecord2 othersong2 dtword2 dtnoword2 totsing3 babylike3 singcomf3 totrecord3 othersong3 dtword3 dtnoword3 totsing4 babylike4 singcomf4 totrecord4 othersong4 dtword4 dtnoword4 totsing5 babylike5 singcomf5 totrecord5 othersong5 dtword5 dtnoword5 totsing6 babylike6 singcomf6 totrecord6 othersong6 dtword6 dtnoword6 totsing7 babylike7 singcomf7 totrecord7 othersong7 dtword7 dtnoword7 totsing8 babylike8 singcomf8 totrecord8 othersong8 dtword8 dtnoword8 totsing9 babylike9 singcomf9 totrecord9 othersong9 dtword9 dtnoword9 totsing10 babylike10 singcomf10 totrecord10 othersong10 dtword10 dtnoword10 totsing11 babylike11 singcomf11 totrecord11 othersong11 dtword11 dtnoword11 totsing12 babylike12 singcomf12 totrecord12 othersong12 dtword12 dtnoword12 totsing13 babylike13 singcomf13 totrecord13 othersong13 dtword13 dtnoword13 totsing14 babylike14 singcomf14 totrecord14 othersong14 dtword14 dtnoword14 filter_$
</pre></div>
</div>
</div>
</div>
<p>Considero la colonna <code class="docutils literal notranslate"><span class="pre">exp1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tot_df</span><span class="p">[</span><span class="s2">&quot;exp1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 0])
</pre></div>
</div>
</div>
</div>
<p>Quando <code class="docutils literal notranslate"><span class="pre">exp1</span></code> assume il valore 1 le osservazioni (righe) appartengono al primo esperimento. Seleziono dunque i dati del primo esperimento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">tot_df</span><span class="p">[</span><span class="n">tot_df</span><span class="p">[</span><span class="s2">&quot;exp1&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(32, 153)
</pre></div>
</div>
</div>
</div>
<p>La variabile <code class="docutils literal notranslate"><span class="pre">Test_Proportion_Gaze_to_Singer</span></code> viene usata per la seconda delle due analisi descritte sopra. Creo un istogramma lisciato (KDE plot, o stima della densità della frequenza dei dati) di questa variabile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">kde</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/melody_11_0.png" src="../_images/melody_11_0.png" />
</div>
</div>
<p>Media, mediana, deviazione standard, minimo e massimo delle proporzioni del tempo intercorso a fissare la faccia della persona target si ottengono nel modo seguente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statistics</span>

<span class="n">summary_stats</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">,</span> <span class="n">statistics</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">statistics</span><span class="o">.</span><span class="n">stdev</span><span class="p">,</span> <span class="nb">max</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">summary_stats</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min       0.262846
median    0.556953
mean      0.593491
stdev     0.178688
max       0.950920
Name: Test_Proportion_Gaze_to_Singer, dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="test-t-di-student-per-un-solo-campione">
<h3>Test <span class="math notranslate nohighlight">\(t\)</span> di Student per un solo campione<a class="headerlink" href="#test-t-di-student-per-un-solo-campione" title="Permalink to this headline">#</a></h3>
<section id="approccio-frequentista">
<h4>Approccio frequentista<a class="headerlink" href="#approccio-frequentista" title="Permalink to this headline">#</a></h4>
<p>Utilizzo l’approccio frequentista per fare inferenza su <span class="math notranslate nohighlight">\(\mu\)</span>, ovvero sulla proporzione media del tempo complessivo di fissazione dello sguardo verso lo sconosciuto che cantava la melodia familiare, piuttosto che verso lo sconosciuto che cantava una canzone ignota. Nel caso della procedura di test di ipotesi, l’ipotesi nulla è</p>
<div class="math notranslate nohighlight">
\[
H_0: \mu = 0.5.
\]</div>
<p>Se non vi è alcuna preferenza, <code class="docutils literal notranslate"><span class="pre">Test_Proportion_Gaze_to_Singer</span></code> dovrebbe assumere il valore 0.5. Se i bambini preferiscono la melodia familiare, il valore medio di <code class="docutils literal notranslate"><span class="pre">Test_Proportion_Gaze_to_Singer</span></code> dovrebbe essere maggiore di 0.5; se i bambini preferiscono la melodia sconosciuta, il valore medio di <code class="docutils literal notranslate"><span class="pre">Test_Proportion_Gaze_to_Singer</span></code> dovrebbe essere minore di 0.5.</p>
<p>Inizio ad esaminare la distribuzione dei dati. Assumo una distribuzione gaussiana e produco un diagramma quantile-quantile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/melody_15_0.png" src="../_images/melody_15_0.png" />
</div>
</div>
<p>Il plot è ragionevolmente lineare per assumere la gaussianità. Dato che l’assunzione di gaussianità è ragionevole, procedo con il <span class="math notranslate nohighlight">\(t\)</span> test.</p>
<p>La proporzione del looking-time diretta allo sconosciuto che canta la melodia familiare è</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.59349125
</pre></div>
</div>
</div>
</div>
<p>L’errore standard della media è</p>
<div class="math notranslate nohighlight">
\[
\sigma_{\bar{y}} = \frac{\sigma}{\sqrt{n}}
\]</div>
<p>ovvero</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">])</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">],</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">std_err</span> <span class="o">=</span> <span class="n">s</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">std_err</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.03158793887638613
</pre></div>
</div>
</div>
</div>
<p>Applico la formula per il calcolo della statistica <em>T</em></p>
<div class="math notranslate nohighlight">
\[
T = \frac{\bar{y} - \mu_0}{\hat{\sigma}_{\bar{y}}} = \frac{0.59 - 0.50}{0.032} = 2.96
\]</div>
<p>ovvero</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_err</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.959713527554351
</pre></div>
</div>
</div>
</div>
<p>I gradi di libertà sono:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">dof</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31
</pre></div>
</div>
</div>
</div>
<p>Per un test bidirezionale, il <span class="math notranslate nohighlight">\(p\)</span>-valore diventa</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.005855685399372312
</pre></div>
</div>
</div>
</div>
<p>Questi risultati si possono facilmente ottenrere usando la funzione <code class="docutils literal notranslate"><span class="pre">t.test()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">],</span> <span class="n">popmean</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=2.959713527554351, pvalue=0.0058556853993721875, df=31)
</pre></div>
</div>
</div>
</div>
<p>e coincidono con quelli trovati sopra e con quelli riportati dagli autori.</p>
<p>L’intervallo di confidenza al 95% si calcola come</p>
<div class="math notranslate nohighlight">
\[
\text{stima del parametro} \pm t \times \text{errore standard}
\]</div>
<p>Nel caso presente, abbiamo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="n">sign</span> <span class="o">*</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">std_err</span> <span class="k">for</span> <span class="n">sign</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.5290672239176627, 0.6579152760823374]
</pre></div>
</div>
</div>
</div>
<p>Tale risultato riproduce quello riportato da Mehr et al. (2016).</p>
<p>Una stima della dimensione dell’effetto si ottiene come il rapporto tra la differenza tra le medie (in questo caso, proporzioni) e la deviazione standard:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">round</span><span class="p">((</span><span class="n">m</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">],</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.52
</pre></div>
</div>
</div>
</div>
<p>Anche questo risultato coincide con il valore riportato dagli autori.</p>
</section>
<section id="analisi-bayesiana">
<h4>Analisi Bayesiana<a class="headerlink" href="#analisi-bayesiana" title="Permalink to this headline">#</a></h4>
<p>Facciamo inferenza su <span class="math notranslate nohighlight">\(\mu\)</span> usando l’approccio bayesiano. I dati sono i seguenti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Considero <span class="math notranslate nohighlight">\(y\)</span> (così come hanno fatto gli autori) come una variabile continua per la quale è sensato assumere un meccanismo generatore dei dati gaussiano di media e deviazione standard ignote. L’inferenza riguarda il parametro <span class="math notranslate nohighlight">\(\mu\)</span> della distribuzione.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

<span class="k">with</span> <span class="n">model1</span><span class="p">:</span>

    <span class="c1"># Priors</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">HalfCauchy</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Likelihood of observations</span>
    <span class="n">Y_obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;Y_obs&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">trace1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Auto-assigning NUTS sampler...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initializing NUTS using jitter+adapt_diag...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiprocess sampling (4 chains in 4 jobs)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NUTS: [mu, sigma]
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='8000' class='' max='8000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [8000/8000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
</div>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 11 seconds.
</pre></div>
</div>
</div>
</div>
<p>La convergenza e il “mixing” del campionamanto MCMC possono essere controllate mediante il <em>trace plot</em> che mostra l’andamento delle simulazioni e ci dice se stiamo effettivamente utilizzando una distribuzione limite:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace1</span><span class="p">,</span> <span class="n">combined</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/melody_37_0.png" src="../_images/melody_37_0.png" />
</div>
</div>
<p>Esamino una sintesi della distribuzione a posteriori del parametro <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace1</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_2.5%</th>
      <th>hdi_97.5%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mu</th>
      <td>0.593</td>
      <td>0.033</td>
      <td>0.531</td>
      <td>0.659</td>
      <td>0.001</td>
      <td>0.0</td>
      <td>3998.682</td>
      <td>3032.649</td>
      <td>1.002</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>0.186</td>
      <td>0.024</td>
      <td>0.143</td>
      <td>0.235</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>3576.654</td>
      <td>2794.307</td>
      <td>1.001</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>I risultati sono simili a quelli riportati dagli autori.</p>
<p>Utilizzo ora una distribuzione a priori Beta, più adeguata per una proporzione.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

<span class="k">with</span> <span class="n">model2</span><span class="p">:</span>

    <span class="c1"># Priors </span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">HalfCauchy</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Likelihood of observations</span>
    <span class="n">Y_obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;Y_obs&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">trace2</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Auto-assigning NUTS sampler...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initializing NUTS using jitter+adapt_diag...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiprocess sampling (4 chains in 4 jobs)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NUTS: [mu, sigma]
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='8000' class='' max='8000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [8000/8000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
</div>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 11 seconds.
</pre></div>
</div>
</div>
</div>
<p>Esamino la distribuzione a posteriori.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace2</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_2.5%</th>
      <th>hdi_97.5%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mu</th>
      <td>0.592</td>
      <td>0.033</td>
      <td>0.530</td>
      <td>0.658</td>
      <td>0.001</td>
      <td>0.0</td>
      <td>3603.726</td>
      <td>2524.860</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>0.187</td>
      <td>0.025</td>
      <td>0.144</td>
      <td>0.240</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>3335.614</td>
      <td>2152.536</td>
      <td>1.003</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>I risultati sono quasi identici a quelli trovati in precedenza.</p>
<p>Posso dunque concludere, con un grado di certezza soggettiva del 95%, che sono sicuri che la proporzione del tempo complessivo di fissazione dello sguardo verso lo sconosciuto che cantava la melodia familiare, piuttosto che verso lo sconosciuto che cantava una canzone ignota, è compresa nell’intervallo [0.53, 0.66]. Dato che questo intervallo non include il valore 0.5, ritengo dunque che i bambini abbiamo dimostrato una preferenza verso lo sconosciuto che cantava una melodia familiare.</p>
</section>
</section>
<section id="confronto-tra-due-gruppi">
<h3>Confronto tra due gruppi<a class="headerlink" href="#confronto-tra-due-gruppi" title="Permalink to this headline">#</a></h3>
<section id="approccio-frequentista-test-t-di-student-per-campioni-appaiati">
<h4>Approccio frequentista (test <span class="math notranslate nohighlight">\(t\)</span> di Student per campioni appaiati)<a class="headerlink" href="#approccio-frequentista-test-t-di-student-per-campioni-appaiati" title="Permalink to this headline">#</a></h4>
<p>Mehr e al. (2016) hanno confrontato il tempo di fissazione dello sguardo verso lo sconosciuto che sorride soltanto e lo sconosciuto che canta la melodia familiare.  La distribuzione dei tempi di fissazione dello sguardo nelle due condizioni è presentata nel pannello a della Figura 2 del loro articolo. Riproduco qui sotto la figura. I tempi di fissazione dello sguardo nelle condizioni baseline e test corrispondono, rispettivamente, alle variabili <code class="docutils literal notranslate"><span class="pre">Baseline_Proportion_Gaze_to_Singer</span></code> e <code class="docutils literal notranslate"><span class="pre">Test_Proportion_Gaze_to_Singer</span></code>.</p>
<p>Per replicare la Figura 2a riportata nell’articolo devo convertire i dati nel formato <em>long</em>, ovvero nel formato in cui a ciascuna colonna del DataFrame corrisponde una variabile. Nel caso presente, creo una variabile chiamata <em>condizione</em>, con modalità <em>baseline</em> e <em>test</em>; una seconda variabile, <em>y</em>, descrive i tempi di fissazione dello sguardo. Per creare un DataFrame che contiene queste due variabili, procedo come segue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Baseline_Proportion_Gaze_to_Singer&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">y</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
<span class="n">group</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;baseline&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Baseline_Proportion_Gaze_to_Singer&quot;</span><span class="p">]),</span>
    <span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">]),</span>
<span class="p">]</span>
<span class="n">grp</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">group</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
<span class="n">mydata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">mydata</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp</span>
<span class="n">mydata</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">mydata</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>baseline</td>
      <td>0.437126</td>
    </tr>
    <tr>
      <th>1</th>
      <td>baseline</td>
      <td>0.412533</td>
    </tr>
    <tr>
      <th>2</th>
      <td>baseline</td>
      <td>0.754491</td>
    </tr>
    <tr>
      <th>3</th>
      <td>baseline</td>
      <td>0.438878</td>
    </tr>
    <tr>
      <th>4</th>
      <td>baseline</td>
      <td>0.474645</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Creo una figura che combina un violin plot e un boxplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mydata</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/melody_47_0.png" src="../_images/melody_47_0.png" />
</div>
</div>
<p>Un confronto tra queste due condizioni viene effettuato con un test <span class="math notranslate nohighlight">\(t\)</span> di Student per campioni appaiati. Ovvero</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_Proportion_Gaze_to_Singer&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Baseline_Proportion_Gaze_to_Singer&quot;</span><span class="p">]</span>
<span class="n">diff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     0.165614
1     0.270494
2    -0.030353
3    -0.157224
4     0.023897
5     0.080019
6     0.181040
7     0.178943
8     0.083665
9    -0.213239
10    0.093946
11   -0.189512
12    0.217782
13   -0.043105
14    0.162541
15   -0.053986
16    0.197520
17   -0.067392
18    0.072766
19    0.096815
20   -0.145358
21    0.532836
22    0.060108
23    0.241541
24   -0.005447
25    0.177075
26    0.131705
27    0.057314
28   -0.279319
29    0.110225
30    0.340925
31    0.024790
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Verifico la gaussianità dei dati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/melody_51_0.png" src="../_images/melody_51_0.png" />
</div>
</div>
<p>La media delle differenze è:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.07239457500000002
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">std_err</span> <span class="o">=</span> <span class="n">s</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">std_err</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.02995930592625408
</pre></div>
</div>
</div>
</div>
<p>La statistica <span class="math notranslate nohighlight">\(T\)</span> è:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_err</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.4164303131121225
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0217529308405513
</pre></div>
</div>
</div>
</div>
<p>Questi risultati replicano i valori riportati dagli autori: <span class="math notranslate nohighlight">\(t_{31}\)</span> = 2.42, <span class="math notranslate nohighlight">\(p\)</span> = 0.022.</p>
<p>L’intervallo di confidenza è</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="n">sign</span><span class="o">*</span><span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">std_err</span> <span class="k">for</span> <span class="n">sign</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.011292167718701236, 0.1334969822812988]
</pre></div>
</div>
</div>
</div>
<p>La dimensione dell’effetto è</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.434003696213157
</pre></div>
</div>
</div>
</div>
<p>Le stime dell’intervallo di confidenza e della dimensione dell’effetto coincidono con i valori riportati da Mehr e al. (2016).</p>
</section>
<section id="id1">
<h4>Analisi bayesiana<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p>Dato che, nel caso di campioni appaiati, abbiamo un unico valore della varibile dipendente per ciascuna “coppia”, l’analisi statistica è sostanzialmente identica a quella già descritta sopra. In questo caso, la variabile dipendente è chiamata <code class="docutils literal notranslate"><span class="pre">diff</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model3</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

<span class="k">with</span> <span class="n">model3</span><span class="p">:</span>

    <span class="c1"># Priors</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">HalfCauchy</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Likelihood of observations</span>
    <span class="n">Y_obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;Y_obs&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">diff</span><span class="p">)</span>
    <span class="n">trace3</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Auto-assigning NUTS sampler...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initializing NUTS using jitter+adapt_diag...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiprocess sampling (4 chains in 4 jobs)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NUTS: [mu, sigma]
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='8000' class='' max='8000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [8000/8000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
</div>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 11 seconds.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace3</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_2.5%</th>
      <th>hdi_97.5%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mu</th>
      <td>0.085</td>
      <td>0.028</td>
      <td>0.030</td>
      <td>0.140</td>
      <td>0.001</td>
      <td>0.0</td>
      <td>2557.333</td>
      <td>2180.752</td>
      <td>1.002</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>0.176</td>
      <td>0.023</td>
      <td>0.135</td>
      <td>0.223</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>3201.689</td>
      <td>2531.852</td>
      <td>1.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>I risultati sono molto simili ai precedenti. Anche la stima della dimensione dell’effetto è simile a quella trovata sopra.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mf">0.084</span> <span class="o">/</span> <span class="mf">0.176</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.47727272727272735
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="analisi-di-regressione">
<h3>Analisi di regressione<a class="headerlink" href="#analisi-di-regressione" title="Permalink to this headline">#</a></h3>
<section id="id2">
<h4>Approccio frequentista<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<p>Mehr et al. (2016) affermano</p>
<blockquote>
<div><p>We used simple linear regression to investigate whether the degree of infants’ increase in attention to the singer of the familiar song from baseline to test depended on their level of in-home exposure to that song. Parents reported singing regularly to their infants (median of 9 performances per day, interquartile range = [4, 11]; estimated total number of song performances: M = 76, SD = 56). After a log2 transformation (because of strong curvature), song exposure was a significant predictor of the within-subjects main effect (Fig. 2b), χ2(1) = 7.53, p = .006, R2 = .14 (Wald test).</p>
</div></blockquote>
<p>Iniziamo a replicare questa analisi statistica usando l’approccio frequentista. Per semplicità, rinomino le due variabili di interesse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Difference_in_Proportion_Looking&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Applico una trasformazione <span class="math notranslate nohighlight">\(log_2\)</span> a <span class="math notranslate nohighlight">\(x\)</span> come riportato dagli autori:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Estimated_Total_Number_of_Song&quot;</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3.700439718141092, 7.936637939002571]
</pre></div>
</div>
</div>
</div>
<p>Creo un diagramma a dispersione con la retta di regressione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize layout</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="c1"># Add scatterplot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="c1"># Fit linear regression via least squares with numpy.polyfit</span>
<span class="c1"># It returns an slope (b) and intercept (a)</span>
<span class="c1"># deg=1 means linear fit (i.e. polynomial of degree 1)</span>
<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Create sequence of 100 numbers from 0 to 100</span>
<span class="n">xseq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="c1"># Plot regression line</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xseq</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">xseq</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Increase in Proportion of Looking from Baseline to Test&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Estimated Number of Times Infant Heard Song ($\log_2$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Estimated Number of Times Infant Heard Song ($\\log_2$)&#39;)
</pre></div>
</div>
<img alt="../_images/melody_72_1.png" src="../_images/melody_72_1.png" />
</div>
</div>
<p>Svolgo l’analisi di regressione con <code class="docutils literal notranslate"><span class="pre">statmodels</span></code>. L’unico indice che gli autori riportanto è <span class="math notranslate nohighlight">\(R^2\)</span>. Il risultato ottenuto qui conferma ciò che è riportato nell’articolo (gli autori riportano anche una statistica <span class="math notranslate nohighlight">\(\chi^2\)</span> che è piuttosto anomala per una regressione).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;y ~ x&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.138
Model:                            OLS   Adj. R-squared:                  0.109
Method:                 Least Squares   F-statistic:                     4.793
Date:                Sun, 29 Jan 2023   Prob (F-statistic):             0.0365
Time:                        09:07:13   Log-Likelihood:                 14.275
No. Observations:                  32   AIC:                            -24.55
Df Residuals:                      30   BIC:                            -21.62
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -0.3034      0.174     -1.744      0.091      -0.659       0.052
x              0.0634      0.029      2.189      0.036       0.004       0.123
==============================================================================
Omnibus:                        0.630   Durbin-Watson:                   2.406
Prob(Omnibus):                  0.730   Jarque-Bera (JB):                0.119
Skew:                          -0.125   Prob(JB):                        0.942
Kurtosis:                       3.165   Cond. No.                         37.9
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>Poniamo attenzione qui alla stima del coefficiente <span class="math notranslate nohighlight">\(\beta\)</span> (l’effetto della <span class="math notranslate nohighlight">\(x\)</span> sulla <span class="math notranslate nohighlight">\(y\)</span>) e all’intervallo di fiducia frequentista per questo parametro.</p>
</section>
<section id="inferenza-bayesiana">
<h4>Inferenza bayesiana<a class="headerlink" href="#inferenza-bayesiana" title="Permalink to this headline">#</a></h4>
<p>Svolgo ora la stessa analisi usando l’approccio bayesiano. Dato che userò delle priors debolmente informative, mi aspetto che i risultati siano molto simili ai precedenti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model4</span><span class="p">:</span>

    <span class="c1"># Define priors</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">HalfCauchy</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># Expected value of outcome</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">x</span>
    <span class="c1"># Likelihood of observations</span>
    <span class="n">Y_obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;Y_obs&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">trace4</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Auto-assigning NUTS sampler...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initializing NUTS using jitter+adapt_diag...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiprocess sampling (4 chains in 4 jobs)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NUTS: [alpha, beta, sigma]
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='24000' class='' max='24000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [24000/24000 00:15&lt;00:00 Sampling 4 chains, 0 divergences]
</div>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 4 chains for 1_000 tune and 5_000 draw iterations (4_000 + 20_000 draws total) took 25 seconds.
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">40</span><span class="p">],</span> <span class="n">line</span> <span class="mi">11</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># Likelihood of observations</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">Y_obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;Y_obs&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="n">trace4</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/pymc/sampling/mcmc.py:621,</span> in <span class="ni">sample</span><span class="nt">(draws, step, init, n_init, initvals, trace, chains, cores, tune, progressbar, model, random_seed, discard_tuned_samples, compute_convergence_checks, callback, jitter_max_retries, return_inferencedata, keep_warning_stat, idata_kwargs, mp_ctx, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">616</span>         <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span>             <span class="s2">&quot;The number of samples is too small to check convergence reliably.&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">618</span>             <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">620</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">621</span>         <span class="n">convergence_warnings</span> <span class="o">=</span> <span class="n">run_convergence_checks</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span>         <span class="n">mtrace</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">_add_warnings</span><span class="p">(</span><span class="n">convergence_warnings</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">624</span> <span class="k">if</span> <span class="n">return_inferencedata</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">625</span>     <span class="c1"># By default we drop the &quot;warning&quot; stat which contains `SamplerWarning`</span>
<span class="g g-Whitespace">    </span><span class="mi">626</span>     <span class="c1"># objects that can not be stored with `.to_netcdf()`.</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/pymc/stats/convergence.py:108,</span> in <span class="ni">run_convergence_checks</span><span class="nt">(idata, model)</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">warn</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span> <span class="n">warnings</span> <span class="o">+=</span> <span class="n">warn_divergences</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">108</span> <span class="n">warnings</span> <span class="o">+=</span> <span class="n">warn_treedepth</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span> <span class="k">return</span> <span class="n">warnings</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/pymc/stats/convergence.py:147,</span> in <span class="ni">warn_treedepth</span><span class="nt">(idata)</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">treedepth</span><span class="o">.</span><span class="n">chain</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">147</span>     <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">treedepth</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="n">treedepth</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;draw&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span>         <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>             <span class="n">SamplerWarning</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>                 <span class="n">WarningType</span><span class="o">.</span><span class="n">TREEDEPTH</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span>             <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span> <span class="k">return</span> <span class="n">warnings</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/_typed_ops.py:206,</span> in <span class="ni">DataArrayOpsMixin.__add__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span> <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">206</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/dataarray.py:4362,</span> in <span class="ni">DataArray._binary_op</span><span class="nt">(self, other, f, reflexive)</span>
<span class="g g-Whitespace">   </span><span class="mi">4360</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DataArray</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">4361</span>     <span class="n">align_type</span> <span class="o">=</span> <span class="n">OPTIONS</span><span class="p">[</span><span class="s2">&quot;arithmetic_join&quot;</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">4362</span>     <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="o">=</span> <span class="n">align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="n">align_type</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<span class="g g-Whitespace">   </span><span class="mi">4363</span> <span class="n">other_variable</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4364</span> <span class="n">other_coords</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;coords&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/alignment.py:797,</span> in <span class="ni">align</span><span class="nt">(join, copy, indexes, exclude, fill_value, *objects)</span>
<span class="g g-Whitespace">    </span><span class="mi">601</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">602</span><span class="sd"> Given any number of Dataset and/or DataArray objects, returns new</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span><span class="sd"> objects with aligned indexes and dimension sizes.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">787</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">788</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">789</span> <span class="n">aligner</span> <span class="o">=</span> <span class="n">Aligner</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span>     <span class="n">objects</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>     <span class="n">join</span><span class="o">=</span><span class="n">join</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>     <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">797</span> <span class="n">aligner</span><span class="o">.</span><span class="n">align</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span> <span class="k">return</span> <span class="n">aligner</span><span class="o">.</span><span class="n">results</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/alignment.py:590,</span> in <span class="ni">Aligner.align</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span>     <span class="bp">self</span><span class="o">.</span><span class="n">override_indexes</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">589</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">590</span>     <span class="bp">self</span><span class="o">.</span><span class="n">reindex_all</span><span class="p">()</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/alignment.py:567,</span> in <span class="ni">Aligner.reindex_all</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">566</span> <span class="k">def</span> <span class="nf">reindex_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">567</span>     <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">568</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_reindex_one</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">matching_indexes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">569</span>         <span class="k">for</span> <span class="n">obj</span><span class="p">,</span> <span class="n">matching_indexes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span>             <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects_matching_indexes</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span>     <span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/alignment.py:568,</span> in <span class="ni">&lt;genexpr&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">566</span> <span class="k">def</span> <span class="nf">reindex_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">567</span>     <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">568</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_reindex_one</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">matching_indexes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">569</span>         <span class="k">for</span> <span class="n">obj</span><span class="p">,</span> <span class="n">matching_indexes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span>             <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects_matching_indexes</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span>     <span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/alignment.py:554,</span> in <span class="ni">Aligner._reindex_one</span><span class="nt">(self, obj, matching_indexes)</span>
<span class="g g-Whitespace">    </span><span class="mi">551</span> <span class="n">new_indexes</span><span class="p">,</span> <span class="n">new_variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_indexes_and_vars</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">matching_indexes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">552</span> <span class="n">dim_pos_indexers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dim_pos_indexers</span><span class="p">(</span><span class="n">matching_indexes</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">554</span> <span class="n">new_obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_reindex_callback</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span>     <span class="n">dim_pos_indexers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span>     <span class="n">new_variables</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span>     <span class="n">new_indexes</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span>     <span class="bp">self</span><span class="o">.</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span>     <span class="bp">self</span><span class="o">.</span><span class="n">exclude_dims</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">561</span>     <span class="bp">self</span><span class="o">.</span><span class="n">exclude_vars</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">562</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">563</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">encoding</span>
<span class="g g-Whitespace">    </span><span class="mi">564</span> <span class="k">return</span> <span class="n">new_obj</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/dataarray.py:1783,</span> in <span class="ni">DataArray._reindex_callback</span><span class="nt">(self, aligner, dim_pos_indexers, variables, indexes, fill_value, exclude_dims, exclude_vars)</span>
<span class="g g-Whitespace">   </span><span class="mi">1780</span>         <span class="n">fill_value</span><span class="p">[</span><span class="n">_THIS_ARRAY</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="g g-Whitespace">   </span><span class="mi">1782</span> <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_temp_dataset</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1783</span> <span class="n">reindexed</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">_reindex_callback</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1784</span>     <span class="n">aligner</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1785</span>     <span class="n">dim_pos_indexers</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1786</span>     <span class="n">variables</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1787</span>     <span class="n">indexes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1788</span>     <span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1789</span>     <span class="n">exclude_dims</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1790</span>     <span class="n">exclude_vars</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1791</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1792</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_temp_dataset</span><span class="p">(</span><span class="n">reindexed</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/dataset.py:2835,</span> in <span class="ni">Dataset._reindex_callback</span><span class="nt">(self, aligner, dim_pos_indexers, variables, indexes, fill_value, exclude_dims, exclude_vars)</span>
<span class="g g-Whitespace">   </span><span class="mi">2833</span>         <span class="n">reindexed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_overwrite_indexes</span><span class="p">(</span><span class="n">new_indexes</span><span class="p">,</span> <span class="n">new_variables</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2834</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2835</span>         <span class="n">reindexed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">aligner</span><span class="o">.</span><span class="n">copy</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2836</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2837</span>     <span class="n">to_reindex</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">   </span><span class="mi">2838</span>         <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
<span class="nn">   2839         for k, v</span> in <span class="ni">self.variables.items</span><span class="nt">()</span>
<span class="g g-Whitespace">   </span><span class="mi">2840</span>         <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">variables</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_vars</span>
<span class="g g-Whitespace">   </span><span class="mi">2841</span>     <span class="p">}</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/dataset.py:1237,</span> in <span class="ni">Dataset.copy</span><span class="nt">(self, deep, data)</span>
<span class="g g-Whitespace">   </span><span class="mi">1138</span> <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1139</span>     <span class="bp">self</span><span class="p">:</span> <span class="n">T_Dataset</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1140</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Dataset</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1141</span>     <span class="sd">&quot;&quot;&quot;Returns a copy of this dataset.</span>
<span class="g g-Whitespace">   </span><span class="mi">1142</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1143</span><span class="sd">     If `deep=True`, a deep copy is made of each of the component variables.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1235</span><span class="sd">     pandas.DataFrame.copy</span>
<span class="g g-Whitespace">   </span><span class="mi">1236</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1237</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/dataset.py:1280,</span> in <span class="ni">Dataset._copy</span><span class="nt">(self, deep, data, memo)</span>
<span class="g g-Whitespace">   </span><span class="mi">1275</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span> <span class="k">if</span> <span class="n">deep</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1276</span> <span class="n">encoding</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1277</span>     <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span> <span class="k">if</span> <span class="n">deep</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1278</span> <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1280</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">indexes</span><span class="o">=</span><span class="n">indexes</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/dataset.py:1026,</span> in <span class="ni">Dataset._replace</span><span class="nt">(self, variables, coord_names, dims, attrs, indexes, encoding, inplace)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span>     <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="n">_default</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1025</span>         <span class="n">encoding</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span>     <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_direct</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1027</span>         <span class="n">variables</span><span class="p">,</span> <span class="n">coord_names</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">indexes</span><span class="p">,</span> <span class="n">encoding</span>
<span class="g g-Whitespace">   </span><span class="mi">1028</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1029</span> <span class="k">return</span> <span class="n">obj</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/dataset.py:976,</span> in <span class="ni">Dataset._construct_direct</span><span class="nt">(cls, variables, coord_names, dims, attrs, indexes, encoding, close)</span>
<span class="g g-Whitespace">    </span><span class="mi">974</span> <span class="n">obj</span><span class="o">.</span><span class="n">_dims</span> <span class="o">=</span> <span class="n">dims</span>
<span class="g g-Whitespace">    </span><span class="mi">975</span> <span class="n">obj</span><span class="o">.</span><span class="n">_indexes</span> <span class="o">=</span> <span class="n">indexes</span>
<span class="ne">--&gt; </span><span class="mi">976</span> <span class="n">obj</span><span class="o">.</span><span class="n">_attrs</span> <span class="o">=</span> <span class="n">attrs</span>
<span class="g g-Whitespace">    </span><span class="mi">977</span> <span class="n">obj</span><span class="o">.</span><span class="n">_close</span> <span class="o">=</span> <span class="n">close</span>
<span class="g g-Whitespace">    </span><span class="mi">978</span> <span class="n">obj</span><span class="o">.</span><span class="n">_encoding</span> <span class="o">=</span> <span class="n">encoding</span>

<span class="nn">File /opt/anaconda3/envs/pymc/lib/python3.10/site-packages/xarray/core/common.py:306,</span> in <span class="ni">AttrAccessMixin.__setattr__</span><span class="nt">(self, name, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span> <span class="sd">&quot;&quot;&quot;Objects with ``__slots__`` raise AttributeError if you try setting an</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span><span class="sd"> undeclared attribute. This is desirable, but the error message could use some</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span><span class="sd"> improvement.</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">306</span>     <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">307</span> <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">308</span>     <span class="c1"># Don&#39;t accidentally shadow custom AttributeErrors, e.g.</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>     <span class="c1"># DataArray.dims.setter</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>     <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> object has no attribute </span><span class="si">{!r}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>         <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">name</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span>     <span class="p">):</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">]</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace4</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="n">var_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;AxesSubplot: title={&#39;center&#39;: &#39;alpha&#39;}&gt;,
        &lt;AxesSubplot: title={&#39;center&#39;: &#39;alpha&#39;}&gt;],
       [&lt;AxesSubplot: title={&#39;center&#39;: &#39;beta&#39;}&gt;,
        &lt;AxesSubplot: title={&#39;center&#39;: &#39;beta&#39;}&gt;],
       [&lt;AxesSubplot: title={&#39;center&#39;: &#39;sigma&#39;}&gt;,
        &lt;AxesSubplot: title={&#39;center&#39;: &#39;sigma&#39;}&gt;]], dtype=object)
</pre></div>
</div>
<img alt="../_images/melody_77_1.png" src="../_images/melody_77_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace4</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_2.5%</th>
      <th>hdi_97.5%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alpha</th>
      <td>-0.3018</td>
      <td>0.1824</td>
      <td>-0.6592</td>
      <td>0.0633</td>
      <td>0.0022</td>
      <td>0.0016</td>
      <td>6853.2719</td>
      <td>7296.0280</td>
      <td>1.0001</td>
    </tr>
    <tr>
      <th>beta</th>
      <td>0.0631</td>
      <td>0.0303</td>
      <td>-0.0000</td>
      <td>0.1199</td>
      <td>0.0004</td>
      <td>0.0003</td>
      <td>6870.3314</td>
      <td>7119.7861</td>
      <td>1.0001</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>0.1668</td>
      <td>0.0227</td>
      <td>0.1243</td>
      <td>0.2115</td>
      <td>0.0003</td>
      <td>0.0002</td>
      <td>7699.8759</td>
      <td>7577.5032</td>
      <td>1.0004</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Come mi attendevo, la stima dei coefficienti è molto simile a quella frequentista. Anche gli intervalli di credibilità sono molto simili agli intervalli di fiducia.</p>
</section>
</section>
</section>
<section id="conclusioni">
<h2>Conclusioni<a class="headerlink" href="#conclusioni" title="Permalink to this headline">#</a></h2>
<p>Mehr e al. (2016) riportano che i bambini di cinque mesi dirigono in modo preferenziale la propria attenzione verso un adulto sconosciuto che canta una melodia familiare piuttosto che verso un adulto sconosciuto che canta una melodia simile, ma sconosciuta. Questi risultati sono stati trovati quando la familiarizzazione con la ninna-nanna target veniva creata mediante l’interazione tra il bambino e un adulto che faceva parte dell’ambiente domestico. L’attenzione dei bambini, invece, non veniva modulata dalla familiarità con la melodia nel caso in cui la melodia in questione fosse stata presentata in precedenza al bambino in un modo diverso, ovvero essendo prodotta da un giocattolo, o da un adulto che il bambino conosceva poco. In base a tali risultati, Mehr e al. (2016) concludono che le melodie prodotte nell’ambiente domestico, attraverso l’interazione tra il bambino e un adulto conosciuto, sono dotate di un particolare significato sociale per i bambini.</p>
</section>
<section id="riferimenti-bibliografici">
<h2>Riferimenti bibliografici<a class="headerlink" href="#riferimenti-bibliografici" title="Permalink to this headline">#</a></h2>
<p>Mehr, S. A., Song, L. A., &amp; Spelke, E. S. (2016). For 5-month-old infants, melodies are social. <em>Psychological Science</em>, <em>27</em>(4), 486-501.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./laboratorio_didattico"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="laboratorio_didattico.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Istruzioni E-tivity</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../esame.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Modalità di verifica dell’apprendimento</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Corrado Caudek<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>